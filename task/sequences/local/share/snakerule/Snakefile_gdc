# TODO write rules and migrate from /home/egrassi/strata/local/share/data - put var in conf.sk - get getfastalen from bit instead of bad perl
ROOT="/home/egrassi"
PRJ_ROOT=ROOT+"/common/task/sequences"
SRC_DIR=PRJ_ROOT+"/local/src"

FASTA="/home/egrassi/strata/local/share/data/GRCh38.d1.vd1.fa"

rule:
    input: FASTA
    output: "chrom_sizes"
    params: tool=SRC_DIR+"/fasta_len.pl"
    shell:
        """
            {params.tool} < {input} > {output}
        """


rule xenome:
    input: graft="genome.fa", host=PRJ_ROOT+"/dataset/iGenomes/mmusculus/mm10/genome.fa"
    output: "xenomidx-both.header"
    singularity: ROOT+"/xenome/xenome.img"
    params: mem=24, thread=8
    shell:
        """
        xenome index -M {params.mem} -T {params.thread} -P xenomidx -H {input.host} -G {input.graft}
        """

#[gdc]egrassi@hactarlogin$ snakemake -j1 xenomidx-both.header --cluster-config=/home/egrassi/strata/local/share/hactar.json --cluster "sbatch --mail-user={cluster.mail-user} --mail-type={cluster.mail-type} --partition={cluster.partition} --nodes={cluster.nodes} --job-name={cluster.job-name} --output={cluster.output} --error={cluster.error} --time=06:00:00 --mem=25000 --ntasks=8" --use-singularity --singularity-args "-B /home/egrassi/:/home/egrassi/"
#
